import{A as B,B as x,C as ee,E as G,F as te,D as H,G as O,H as oe,U as ne,S as se,I as ae}from"./el-notification-75267e31.js";import{_ as le,a as ce,E as ie,b as re,c as ue,d as de,P as _e,e as J,F,f as me,j as pe,h as ve,i as fe,k as ge,l as Ee}from"./Field-1cb80303.js";import{I as j,c as U,J as he,a as h,b as C,g as a,h as u,f as s,k as L,K as b,B as S,v as Te,_ as Ie,r as y,p as R,y as $,q as De,u as c,l as M,i as z,N as m,O as ye,o as we,F as W,t as ke,P as Ce,Q as be,R as Ae}from"./index-b42fd8e6.js";const Ve={class:"header__left"},Oe=u("div",{class:"header__center"},[u("img",{src:le,alt:"logo"}),b(" DNTA BOX ")],-1),Le={class:"header__right"},Pe=["nsfw","title"],Se={__name:"header",emits:["hideMenu"],setup(f,{emit:g}){const n=j(),t=B(),o=U(()=>t.nsfw),l=U(()=>x.getItem("userInfo")||{}),v=()=>{t.UPDATE_NSFW(o.value?0:1),setTimeout(()=>{window.location.reload()},0)},E=()=>{g("hideMenu")},T=()=>{x.remove("userInfo"),ee.remove("token"),n.push("/login")};return(I,D)=>{const e=ce,_=G,d=ie,w=re,k=ue,A=de,i=he("lazy");return h(),C(A,{class:"header"},{default:a(()=>[u("div",Ve,[s(_,{size:24,class:"menu",title:"收起",onClick:L(E,["stop"])},{default:a(()=>[s(e)]),_:1},8,["onClick"])]),Oe,u("div",Le,[s(k,{"show-timeout":0},{dropdown:a(()=>[s(w,null,{default:a(()=>[s(d,{onClick:v},{default:a(()=>[b(S(o.value?"SFW":"NSFW"),1)]),_:1}),s(d,{onClick:T},{default:a(()=>[b("LOGOUT")]),_:1})]),_:1})]),default:a(()=>[u("div",{class:"user",onClick:D[0]||(D[0]=L(()=>{},["stop"]))},[Te(u("img",{nsfw:!!o.value,class:"avatar",title:l.value.nick_name},null,8,Pe),[[i,l.value.avatar]])])]),_:1})])]),_:1})}}};const Re={class:"tag-label"},Be={class:"count"},Ne={__name:"TagItem",props:{label:{type:String,default:""},active:{type:Boolean,default:!1},edit:{type:Boolean,default:!1},drag:{type:Boolean,default:!1},id:{type:[Number,String],default:""},count:{type:[Number,String],default:""},icon:{type:String,default:""}},emits:["onLeftClick","onEdit"],setup(f,{emit:g}){const n=f,t=B(),o=y(!1);let l=null;if(n.icon){const _=Object.assign({"/src/components/Icon/IcBaselineFavoriteBorder.vue":()=>m(()=>import("./IcBaselineFavoriteBorder-8115e1e5.js"),["assets/IcBaselineFavoriteBorder-8115e1e5.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/IcOutlineAutoDelete.vue":()=>m(()=>import("./IcOutlineAutoDelete-087b3bf1.js"),["assets/IcOutlineAutoDelete-087b3bf1.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/IcRoundFolderSpecial.vue":()=>m(()=>import("./IcRoundFolderSpecial-ebe3eccc.js"),["assets/IcRoundFolderSpecial-ebe3eccc.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/IcRoundRestorePage.vue":()=>m(()=>import("./IcRoundRestorePage-1018d7e4.js"),["assets/IcRoundRestorePage-1018d7e4.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/IcRoundVideoCameraBack.vue":()=>m(()=>import("./IcRoundVideoCameraBack-966a12d3.js"),["assets/IcRoundVideoCameraBack-966a12d3.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/MdiDeleteForeverOutline.vue":()=>m(()=>import("./MdiDeleteForeverOutline-5e5c40bb.js"),["assets/MdiDeleteForeverOutline-5e5c40bb.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/MdiPauseCircle.vue":()=>m(()=>import("./MdiPauseCircle-8e4adac2.js"),["assets/MdiPauseCircle-8e4adac2.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/MdiPlayCircle.vue":()=>m(()=>import("./MdiPlayCircle-d35a1016.js"),["assets/MdiPlayCircle-d35a1016.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/MdiSortAscending.vue":()=>m(()=>import("./MdiSortAscending-8729b202.js"),["assets/MdiSortAscending-8729b202.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/MdiViewDashboardVariant.vue":()=>m(()=>import("./MdiViewDashboardVariant-3822f392.js"),["assets/MdiViewDashboardVariant-3822f392.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/MdiWeb.vue":()=>m(()=>import("./MdiWeb-5367c414.js"),["assets/MdiWeb-5367c414.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"]),"/src/components/Icon/PhPenThin.vue":()=>m(()=>import("./Field-1cb80303.js").then(d=>d.m),["assets/Field-1cb80303.js","assets/el-notification-75267e31.js","assets/index-b42fd8e6.js","assets/index-f952270e.css","assets/el-notification-33aecef6.css","assets/Field-ff790aa1.css"]),"/src/components/Icon/TagOutline.vue":()=>m(()=>import("./TagOutline-71567e45.js"),["assets/TagOutline-71567e45.js","assets/index-b42fd8e6.js","assets/index-f952270e.css"])})[`/src/components/Icon/${n.icon}.vue`];l=ye(_)}const v=()=>{g("onLeftClick")},E=()=>{g("onEdit")},T=e=>{var _;e.preventDefault(),o.value=((_=t.dragData)==null?void 0:_.tid)===n.id,!(!n.drag||o.value)&&e.target.toggleAttribute("over",!0)},I=e=>{e.preventDefault(),!(!n.drag||o.value)&&e.target.toggleAttribute("over",!1)},D=async e=>{if(e.preventDefault(),e.target.toggleAttribute("over",!1),!n.drag||o.value||!t.dragData)return;const _=JSON.parse(JSON.stringify(t.dragData));if(t.checkList&&t.checkList.length>1)try{await J.confirm(`确定要把当前选中的 ${t.checkList.length} 项全部移动到此分类吗？`,"",{confirmButtonText:"移动",cancelButtonText:"取消"})}catch{return}const d={ids:[_.id],tid:n.id};t.checkList.length>1&&(d.ids=t.checkList.map(i=>i.id));const w=await te(d),{success:k,msg:A}=w;if(!k){H.error(A);return}O({title:"操作成功",message:`已移动到 ${n.label}`,type:"success"}),t.UPDATE_DRAG_DATA(null),t.UPDATE_CHECK_LIST([]),t.active!==-1&&t.UPDATE_FAVORITE_LIST(t.favoriteList.filter(i=>!d.ids.includes(i.id)))};return(e,_)=>{const d=G;return h(),R("div",{class:z(["tag",{active:n.active}]),onDragenter:T,onDragleave:I,onDrop:D},[u("div",{class:z(["tag-item flex-center",{"no-events":f.drag}])},[s(d,{size:20,class:"icon",onClick:L(v,["stop"])},{default:a(()=>[$(e.$slots,"default",{},void 0,!0),n.icon?(h(),C(De(c(l)),{key:0})):M("",!0)]),_:3},8,["onClick"]),u("span",Re,[b(S(n.label)+" ",1),$(e.$slots,"label",{},void 0,!0),u("span",Be,S(n.count),1)])],2),n.edit?(h(),C(d,{key:0,size:18,class:"edit",onClick:L(E,["stop"])},{default:a(()=>[s(c(_e))]),_:1},8,["onClick"])):M("",!0)],34)}}},P=Ie(Ne,[["__scopeId","data-v-20ebb731"]]);function q(){const f=y(!1);return{fetch:async(n,t,o=()=>{},l=()=>{})=>{f.value=!0;const v=await n(t);f.value=!1;const{data:E,success:T,msg:I}=v;return T?(o(E),E):(H.error(I),l(),!1)},loading:f}}const xe=f=>{const{loading:g,fetch:n}=q(),t=y(!1),o=y(null),l=y("");return{onDel:()=>{t.value=!1,J.confirm("删除收藏夹后，所有收藏将被移动至 未分类收藏，是否继续删除？","警告",{confirmButtonText:"删除",cancelButtonText:"取消"}).then(async()=>{await n(oe,{id:o.value.id})&&O({title:"操作成功",message:"已删除",type:"success"})}).catch(()=>{t.value=!0})},onUpdateTag:async()=>{if(!await n(void 0,{id:o.value.id,name:o.value.name,nsfw:o.value.nsfw})){o.value.name=l.value;return}l.value="",t.value=!1,O({title:"操作成功",message:"更新成功",type:"success"})},onEdit:e=>{o.value=e,l.value=e.name,t.value=!0},onAddTag:async()=>{if(!tagName.value||!tagName.value.trim())return;const e=await n(ne,{name:tagName.value.trim()});e&&(O({title:"操作成功",message:"已添加",type:"success"}),targetList.value=[...targetList.value,{id:e,name:tagName.value}])},handleClose:e=>{o.value&&l.value&&(o.value.name=l.value),e()},selectTag:o,dialogVisible:t}};const Fe={class:"aside__wrap"},Ue={class:"edit-container"},$e={class:"edit-form-item"},Me=u("p",{class:"label"},"收藏夹名字",-1),ze={class:"edit-form-item"},We={class:"dialog-footer"},Ge={__name:"aside",setup(f){const g={name:"未分类",key:"uncategorized",icon:"TagOutline"},n=j(),t=B(),{loading:o,fetch:l}=q(),{onDel:v,onUpdateTag:E,onEdit:T,onAddTag:I,handleClose:D,selectTag:e,dialogVisible:_}=xe(),d=y([]),w=y(""),k=({key:i,id:p})=>{let V=p;i==="all"&&(V=""),i==="uncategorized"&&(V=0),n.replace({name:"collect",params:{tid:V,type:i}})},A=async()=>{const i=await l(se,{nsfw:t.nsfw});i&&(console.log(i),d.value=[...i,g])};return we(()=>{A()}),(i,p)=>{const V=me,K=pe,Q=ve,N=ae,X=fe;return h(),R(W,null,[s(K,{class:"aside"},{default:a(()=>[s(P,{label:"我的收藏",onClick:p[0]||(p[0]=r=>k({key:"all"})),icon:"IcRoundFolderSpecial"}),u("div",Fe,[(h(!0),R(W,null,ke(d.value,(r,Y)=>(h(),C(P,{key:Y,label:r.name,onClick:Z=>k(r),icon:r.icon||"IcBaselineFavoriteBorder",edit:"",onOnEdit:Z=>c(T)(r),id:r.id,drag:"",count:r.favorite_count},null,8,["label","onClick","icon","onOnEdit","id","count"]))),128)),s(P,{onOnLeftClick:c(I)},{label:a(()=>[s(F,{modelValue:w.value,"onUpdate:modelValue":p[1]||(p[1]=r=>w.value=r),placeholder:"输入收藏夹名字",onEnter:c(I)},null,8,["modelValue","onEnter"])]),default:a(()=>[s(V)]),_:1},8,["onOnLeftClick"])])]),_:1}),s(X,{modelValue:c(_),"onUpdate:modelValue":p[4]||(p[4]=r=>Ce(_)?_.value=r:null),title:"编辑收藏夹","before-close":c(D),"append-to-body":"",class:"edit-dialog",draggable:"","destroy-on-close":""},{footer:a(()=>[u("span",We,[s(N,{type:"primary",onClick:c(v),loading:c(o)},{default:a(()=>[b("删除收藏夹")]),_:1},8,["onClick","loading"]),s(N,{onClick:c(E),loading:c(o)},{default:a(()=>[b("更新")]),_:1},8,["onClick","loading"])])]),default:a(()=>[u("div",Ue,[u("div",$e,[Me,s(F,{placeholder:"输入收藏夹名字",modelValue:c(e).name,"onUpdate:modelValue":p[2]||(p[2]=r=>c(e).name=r)},null,8,["modelValue"])]),u("div",ze,[s(Q,{modelValue:c(e).nsfw,"onUpdate:modelValue":p[3]||(p[3]=r=>c(e).nsfw=r),"inactive-value":1,style:{"--el-switch-on-color":"#5dca91","--el-switch-off-color":"#ff4242","--el-color-primary":"#f101eb"},"active-value":0,"active-text":"SFW","inactive-text":"NSFW"},null,8,["modelValue"])])])]),_:1},8,["modelValue","before-close"])],64)}}};const qe={__name:"index",setup(f){const g=be();return(n,t)=>{const o=Ae("router-view"),l=Ee,v=ge;return h(),C(v,{direction:"vertical",class:"home"},{default:a(()=>[s(Se),s(v,{class:"home__container"},{default:a(()=>[s(Ge),s(l,{class:"home__main"},{default:a(()=>[(h(),C(o,{key:c(g).path}))]),_:1})]),_:1})]),_:1})}}};export{qe as default};
